<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä - ‡•≠</title>
    <link rel="stylesheet" href="../../extjs/resources/ext-all.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #dfe9f6;
            font-size: 13px;
        }

        .form-container {
            background-color: #dfe9f6;
            padding: 20px;
            max-width: 100%;
            margin: 0;
        }

        .form-header {
            background-color: #d0e4f7;
            padding: 10px;
            border: 1px solid #9bc2e6;
            margin-bottom: 10px;
            border-radius: 3px;
        }

        .form-title {
            font-size: 20px;
            text-align: center;
            margin: 10px 0 20px;
            font-weight: bold;
        }

        .print-btn {
            background-color: #5b9bd5;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 10px;
        }

        .print-btn:hover {
            background-color: #4a8bc2;
        }

        .info-panel {
            background-color: #dfe9f6;
            border: 1px solid #b8d4e8;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }

        .info-row {
            display: flex;
            margin-bottom: 10px;
            align-items: center;
        }

        .info-label {
            font-weight: bold;
            margin-right: 10px;
            min-width: 150px;
        }

        .info-input {
            flex: 1;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 3px;
        }

        .grid-container {
            margin: 10px 0;
            border: 1px solid #d0d0d0;
            border-radius: 4px;
            overflow: hidden;
        }

        .grid-header {
            background-color: #b8d4e8;
            padding: 10px;
            font-weight: bold;
            border-bottom: 1px solid #9bc2e6;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
        }

        th, td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background-color: #d0e4f7;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        .input-field {
            width: 150px;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 3px;
            text-align: right;
        }

        .readonly {
            background-color: #f0f0f0;
        }

        .action-buttons {
            margin: 20px 0;
            display: flex;
            gap: 10px;
        }

        .btn-save {
            background-color: #f8f9fa;
            color: #333;
            border: 1px solid #ccc;
            padding: 6px 12px;
            border-radius: 3px;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.12);
            display: inline-flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
        }

        .btn-save:hover {
            background-color: #e9ecef;
            box-shadow: 0 2px 4px rgba(0,0,0,0.15);
        }
        
        .btn-save::before {
            content: "üíæ";
            font-size: 16px;
            filter: hue-rotate(200deg) saturate(1.5);
        }
        
        .btn-save.updated::before {
            content: "";
        }

        .btn-delete {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            display: none;
        }

        .btn-delete:hover {
            background-color: #c0392b;
        }

        .back-link {
            margin: 10px 0;
            font-size: 13px;
        }

        .back-link a {
            color: #dc3545;
            text-decoration: underline;
            cursor: pointer;
            font-weight: normal;
        }
        
        .back-link a:hover {
            color: #c82333;
        }
        
        /* Success Modal Styles */
        .modal-overlay {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.10);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: #eaf1fa;
            border-radius: 8px;
            min-width: 320px;
            max-width: 90vw;
            box-shadow: 0 2px 16px rgba(0,0,0,0.2);
            position: relative;
            border: 1.5px solid #b5cbe7;
            padding: 0;
        }
        .modal-header {
            padding: 10px 18px 0 18px;
            font-size: 16px;
            font-weight: bold;
            color: #1a4b8c;
            letter-spacing: 0.5px;
        }
        .modal-close {
            position: absolute;
            top: 8px;
            right: 14px;
            font-size: 18px;
            cursor: pointer;
            color: #888;
        }
        .modal-body {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 10px 18px 0 18px;
        }
        .modal-icon {
            margin-top: 2px;
        }
        .modal-message {
            font-size: 15px;
            color: #222;
            line-height: 1.5;
        }
        .modal-footer {
            text-align: center;
            padding: 16px 0 10px 0;
        }
        .modal-ok-btn {
            padding: 3px 32px;
            background: #e3eaf3;
            border: 1.5px solid #b5cbe7;
            border-radius: 3px;
            font-size: 15px;
            cursor: pointer;
            color: #1a4b8c;
            font-weight: bold;
        }
        .modal-ok-btn:hover {
            background: #d5e2f0;
        }
        
        /* Confirmation Modal Styles */
        .confirm-modal-overlay {
            display: none;
            position: fixed;
            z-index: 10001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.15);
            align-items: center;
            justify-content: center;
        }
        .confirm-modal-content {
            background: #e8f1fa;
            border-radius: 8px;
            min-width: 400px;
            max-width: 90vw;
            box-shadow: 0 2px 16px rgba(0,0,0,0.2);
            position: relative;
            border: 1.5px solid #9bc2e6;
            padding: 0;
        }
        .confirm-modal-header {
            padding: 10px 18px;
            font-size: 16px;
            font-weight: bold;
            color: #1a4b8c;
            letter-spacing: 0.5px;
            border-bottom: 1px solid #9bc2e6;
        }
        .confirm-modal-close {
            position: absolute;
            top: 8px;
            right: 14px;
            font-size: 20px;
            cursor: pointer;
            color: #888;
            font-weight: normal;
        }
        .confirm-modal-body {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 20px 18px;
        }
        .confirm-modal-icon {
            font-size: 48px;
        }
        .confirm-modal-message {
            font-size: 15px;
            color: #222;
            line-height: 1.6;
        }
        .confirm-modal-footer {
            text-align: center;
            padding: 10px 18px 15px 18px;
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        .confirm-btn {
            padding: 5px 28px;
            background: #d4e4f7;
            border: 1.5px solid #9bc2e6;
            border-radius: 3px;
            font-size: 15px;
            cursor: pointer;
            color: #1a4b8c;
            font-weight: bold;
            min-width: 80px;
        }
        .confirm-btn:hover {
            background: #c4d8f0;
        }
    </style>
</head>
<body>
    <!-- Success Modal -->
    <div id="successModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                SUCCESS
                <span class="modal-close" onclick="closeSuccessModal()">&times;</span>
            </div>
            <div class="modal-body">
                <span class="modal-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32">
                        <circle cx="16" cy="16" r="16" fill="#b5cbe7"/>
                        <text x="16" y="22" text-anchor="middle" font-size="20" fill="#1a4b8c" font-family="Arial, sans-serif">i</text>
                    </svg>
                </span>
                <span class="modal-message">Successfully saved.</span>
            </div>
            <div class="modal-footer">
                <button class="modal-ok-btn" onclick="closeSuccessModal()">OK</button>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirmModal" class="confirm-modal-overlay">
        <div class="confirm-modal-content">
            <div class="confirm-modal-header">
                Confirm Action
                <span class="confirm-modal-close" onclick="closeConfirmModal()">&times;</span>
            </div>
            <div class="confirm-modal-body">
                <span class="confirm-modal-icon">‚ùì</span>
                <span class="confirm-modal-message">‡§ï‡•á ‡§§‡§™‡§æ‡§à‡§Ç ‡§™‡§õ‡§æ‡§°‡§ø ‡§ó‡§è‡§∞ ‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä ‡§§‡§Ø ‡§ó‡§∞‡•ç‡§® ‡§ö‡§æ‡§π‡§®‡•Å‡§π‡•Å‡§®‡•ç‡§õ?</span>
            </div>
            <div class="confirm-modal-footer">
                <button class="confirm-btn" onclick="confirmGoBack()">Yes</button>
                <button class="confirm-btn" onclick="closeConfirmModal()">No</button>
            </div>
        </div>
    </div>
    
    <div class="form-container">
        <button class="print-btn">Print</button>
        
        <div class="form-title">‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä - ‡•≠</div>

        <div class="back-link" style="margin: 10px 0;">
            ‡§™‡§õ‡§æ‡§°‡§ø ‡§ó‡§è‡§∞ ‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä ‡§§‡§Ø ‡§ó‡§∞‡•ç‡§® <a id="backLink">‡§Ø‡§π‡§æ‡§Å ‡§ï‡§ø‡•ç‡§≤‡§ï</a> ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç ‡•§
        </div>

        <div class="info-panel">
            <div class="info-row">
                <label class="info-label">‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§µ‡§∞‡•ç‡§∑:</label>
                <input type="text" class="info-input" id="fiscalYear" style="max-width: 200px;">
                <label class="info-label" style="margin-left: auto; margin-right: 10px;">‡§Ü.‡§∞‡§æ.‡§ï‡§æ:</label>
                <input type="text" class="info-input" id="internalCode" style="max-width: 250px;">
            </div>
            <div class="info-row">
                <label class="info-label">‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§≤‡•á‡§ñ‡§æ ‡§®‡§Æ‡•ç‡§¨‡§∞:</label>
                <input type="text" class="info-input" id="panNumber" style="max-width: 200px;">
            </div>
            <div class="info-row">
                <label class="info-label">‡§®‡§æ‡§Æ:</label>
                <input type="text" class="info-input" id="taxpayerName">
            </div>
        </div>

        <!-- Inclusion Section -->
        <div class="grid-container">
            <div class="grid-header">Inclusion (IN)</div>
            <table>
                <tbody>
                    <tr>
                        <td>1</td>
                        <td>‡§≤‡§æ‡§≠‡§æ‡§Ç‡§∂ (‡§Ö‡§®‡•ç‡§§‡§ø‡§Æ ‡§∞‡•Å‡§™‡§Æ‡§æ ‡§ï‡§∞ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§®‡§≠‡§è‡§ï‡•ã ‡§Æ‡§æ‡§§‡•ç‡§∞)‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ï<br>Dividends (Section 9.2.a)</td>
                        <td><input type="text" class="input-field" id="txtIN0"></td>
                    </tr>
                    <tr>
                        <td>2</td>
                        <td>‡§≤‡§ó‡§æ‡§®‡•Ä ‡§¨‡•Ä‡§Æ‡§æ‡§¨‡§æ‡§ü ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§≤‡§æ‡§≠ ‡§Ö‡§®‡•ç‡§§‡§ø‡§Æ ‡§∞‡•Å‡§™‡§Æ‡§æ ‡§ï‡§∞ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§®‡§≠‡§è‡§ï‡•ã ‡§Æ‡§æ‡§§‡•ç‡§∞ ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ï<br>Gain from Investment Insurance other than final Withholding (Section 9.2.a)</td>
                        <td><input type="text" class="input-field" id="txtIN1"></td>
                    </tr>
                    <tr>
                        <td>3</td>
                        <td>‡§¨‡•ç‡§Ø‡§æ‡§ú (‡§Ö‡§®‡•ç‡§§‡§ø‡§Æ ‡§∞‡•Å‡§™‡§Æ‡§æ ‡§ï‡§∞ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§®‡§≠‡§è‡§ï‡•ã ‡§Æ‡§æ‡§§‡•ç‡§∞)‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ï<br>Interests other than final Withholding (Section 9.2.a)</td>
                        <td><input type="text" class="input-field" id="txtIN2"></td>
                    </tr>
                    <tr>
                        <td>4</td>
                        <td>‡§≠‡§æ‡§°‡§æ (‡§Ö‡§®‡•ç‡§§‡§ø‡§Æ ‡§∞‡•Å‡§™‡§Æ‡§æ ‡§ï‡§∞ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§®‡§≠‡§è‡§ï‡•ã ‡§Æ‡§æ‡§§‡•ç‡§∞)‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ï<br>Rent other than final Withholding  (Section 9.2.a)</td>
                        <td><input type="text" class="input-field" id="txtIN3"></td>
                    </tr>
                    <tr>
                        <td>5</td>
                        <td>‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§∏‡•ç‡§∞‡•ã‡§§ ‡§µ‡§æ‡§™‡§§‡§ï‡•ã ‡§≠‡•Å‡§ï‡•ç‡§§‡§æ‡§®‡•Ä ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ï<br>Payment for natural Resources other than final Withholding  (Section 9.2.a)</td>
                        <td><input type="text" class="input-field" id="txtIN4"></td>
                    </tr>
                    <tr>
                        <td>6</td>
                        <td>‡§∞‡•ã‡§Ø‡§≤‡•ç‡§ü‡•Ä ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ï<br>Royalties (Section 9.2.a)</td>
                        <td><input type="text" class="input-field" id="txtIN5"></td>
                    </tr>
                    <tr>
                        <td>7</td>
                        <td>‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§®‡§ó‡§∞‡•á‡§ï‡•ã ‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§ï‡•ã‡§∑‡§ï‡•ã ‡§π‡§ø‡§§‡§¨‡§æ‡§ü ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§≤‡§æ‡§≠ ‡§Ö‡§®‡•ç‡§§‡§ø‡§Æ ‡§∞‡•Å‡§™‡§Æ‡§æ ‡§ï‡§∞ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§®‡§≠‡§è‡§Æ‡§æ ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ï<br>Unapproved Retirement Fund other than Withholding (Section 9.2.a)</td>
                        <td><input type="text" class="input-field" id="txtIN6"></td>
                    </tr>
                    <tr>
                        <td>8</td>
                        <td>‡§π‡•ç‡§∞‡§æ‡§∏‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§∏‡§Æ‡•ç‚Äç‡§™‡§§‡•ç‚Äç‡§§‡§ø‡§ï‡•ã ‡§®‡§ø‡§∏‡§∞‡•ç‡§ó‡§¨‡§æ‡§ü ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‚Äç‡§§ ‡§≤‡§æ‡§≠ ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ó<br>Disposal of depreciable Assets (Section 9.2.c)</td>
                        <td><input type="text" class="input-field" id="txtIN7"></td>
                    </tr>
                    <tr>
                        <td>9</td>
                        <td>‡§≤‡§ó‡§æ‡§®‡•Ä‡§ï‡§æ ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§Æ‡§æ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ó‡§∞‡•á‡§ï‡•ã ‡§â‡§™‡§π‡§æ‡§∞ ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ò<br>Gifts received by the Person in Respect of Investment  (Section 9.2.d)</td>
                        <td><input type="text" class="input-field" id="txtIN8"></td>
                    </tr>
                    <tr>
                        <td>10</td>
                        <td>‡§Ö‡§µ‡§ï‡§æ‡§∏ ‡§≠‡•Å‡§ï‡•ç‡§§‡§æ‡§®‡•Ä ‡§∞ ‡§∏‡•ã ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï‡•ã ‡§≤‡§æ‡§ó‡§ø ‡§Ö‡§µ‡§ï‡§æ‡§∏ ‡§ï‡•ã‡§∑‡§Æ‡§æ ‡§ú‡§Æ‡•ç‡§Æ‡§æ ‡§ó‡§∞‡§ø‡§è‡§ï‡•ã ‡§∞‡§ï‡§Æ ‡§∏‡§Æ‡•á‡§§‡§ï‡•ã ‡§Ö‡§µ‡§ï‡§æ‡§∂ ‡§Ø‡•ã‡§ó‡§¶‡§æ‡§® ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ô<br>Retirement Payment along with Payments Retirement Contributions made on behalf (Section 9.2.e)</td>
                        <td><input type="text" class="input-field" id="txtIN9"></td>
                    </tr>
                    <tr>
                        <td>11</td>
                        <td>‡§≤‡§ó‡§æ‡§®‡•Ä‡§ï‡•ã ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§Æ‡§æ ‡§ï‡•Å‡§®‡•à ‡§™‡•ç‡§∞‡§§‡§ø‡§¨‡§®‡•ç‡§ß ‡§∏‡•ç‡§µ‡•Ä‡§ï‡§æ‡§∞ ‡§ó‡§∞‡•á ‡§µ‡§æ‡§™‡§§ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ó‡§∞‡•á‡§ï‡•ã ‡§∞‡§ï‡§Æ ‡§¶‡§´‡§æ ‡•Ø(‡•®)‡§ö<br>Amounts derived as Consideration for accepting a Restriction of Investment (Section 9.2.f)</td>
                        <td><input type="text" class="input-field" id="txtIN10"></td>
                    </tr>
                    <tr>
                        <td>12</td>
                        <td>‡§≤‡•á‡§ñ‡§æ‡§Ç‡§ï‡§®‡§ï‡•ã ‡§§‡§∞‡§ø‡§ï‡§æ‡§Æ‡§æ ‡§™‡§∞‡§ø‡§µ‡§∞‡•ç‡§§‡§® ‡§ó‡§∞‡•ç‡§¶‡§æ ‡§Ü‡§Ø ‡§ó‡§£‡§®‡§æ‡§Æ‡§æ ‡§∏‡§Æ‡§æ‡§µ‡•á‡§∂ ‡§ó‡§∞‡•ç‡§®‡•Å ‡§™‡§∞‡•ç‡§®‡•á ‡§∞‡§ï‡§Æ ‡§¶‡§´‡§æ ‡•®‡•®(‡•¨)<br>Amounts to be included by Reason of Timing (Section 24.3)</td>
                        <td><input type="text" class="input-field" id="txtIN11"></td>
                    </tr>
                    <tr>
                        <td>13</td>
                        <td>‡§Æ‡•Å‡§¶‡•ç‡§∞‡§æ‡§ï‡•ã ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§®‡§ï‡•ã ‡§´‡§∞‡§ï‡§ï‡•ã ‡§ï‡§æ‡§∞‡§£‡§≤‡•á ‡§ó‡§∞‡•ç‡§¶‡§æ ‡§∏‡§Æ‡•á‡§§ ‡§¨‡§¢‡•Ä ‡§≠‡•Å‡§ï‡•ç‡§§‡§æ‡§®‡•Ä ‡§™‡§æ‡§è‡§ï‡•ã ‡§∞‡§ï‡§Æ ‡§¶‡§´‡§æ ‡•®‡•™(‡•™)<br>Excess Amount received by reason of Exchange Rate (Section 24.4)</td>
                        <td><input type="text" class="input-field" id="txtIN12"></td>
                    </tr>
                    <tr>
                        <td>14</td>
                        <td>‡§°‡•Å‡§¨‡•á‡§ï‡•ã ‡§ã‡§£ ‡§≤‡§ó‡§æ‡§Ø‡§§‡§ï‡§æ ‡§∞‡§ï‡§Æ‡§π‡§∞‡•Å ‡§Æ‡§ø‡§®‡•ç‡§π‡§æ ‡§≠‡§è‡§ï‡•ã ‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§Ö‡§∏‡•Å‡§≤ ‡§â‡§™‡§∞ ‡§≠‡§è‡§ï‡•ã ‡§∞‡§ï‡§Æ ‡§¶‡§´‡§æ ‡•®‡•´(‡•ß)<br>Recovered Amount of bad Debts deducted earlier (Section 25.1)</td>
                        <td><input type="text" class="input-field" id="txtIN13"></td>
                    </tr>
                    <tr>
                        <td>15</td>
                        <td>‡§™‡•ç‡§∞‡§ö‡§≤‡§ø‡§§ ‡§¨‡•ç‡§Ø‡§æ‡§ú‡§¶‡§∞ ‡§≠‡§®‡•ç‡§¶‡§æ ‡§ï‡§Æ ‡§¶‡§∞‡§Æ‡§æ ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§§‡§ø‡§∞‡•á‡§ï‡•ã ‡§≠‡§è ‡§ï‡§Æ ‡§≠‡§è‡§ú‡§§‡§ø ‡§∞‡§ï‡§Æ (‡•®‡•≠.‡•ß.‡•©)<br>Difference of actual Interest and Interest as per Market Rate in Case of a Soft Loan (Section 25.1.d)</td>
                        <td><input type="text" class="input-field" id="txtIN14"></td>
                    </tr>
                    <tr>
                        <td>16</td>
                        <td>‡§≠‡•Å‡§ï‡•ç‡§§‡§æ‡§®‡•Ä ‡§™‡§æ‡§â‡§®‡•Å ‡§™‡§∞‡•ç‡§®‡•á ‡§∞‡§ï‡§Æ ‡§Ö‡§∞‡•ç‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§≤‡•á ‡§≠‡•Å‡§ï‡•ç‡§§‡§æ‡§®‡•Ä ‡§™‡§æ‡§è‡§Æ‡§æ ‡§∏‡•ã ‡§∞‡§ï‡§Æ ‡§¶‡§´‡§æ ‡•®‡•Ø<br>Amounts paid to third Person instead of actual Payee (Section 29)</td>
                        <td><input type="text" class="input-field" id="txtIN15"></td>
                    </tr>
                    <tr>
                        <td>17</td>
                        <td>‡§∏‡§Ç‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§∏‡•ç‡§µ‡§æ‡§Æ‡§ø‡§§‡•ç‡§µ‡§Æ‡§æ ‡§∞‡§π‡•á‡§ï‡•ã ‡§≤‡§ó‡§æ‡§®‡•Ä‡§¨‡§æ‡§ü ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ó‡§∞‡•á‡§ï‡•ã ‡§∞‡§ï‡§Æ ‡§¶‡§´‡§æ ‡•©‡•¶<br>Amounts derived from joint Ownership Investment (Section 30)</td>
                        <td><input type="text" class="input-field" id="txtIN16"></td>
                    </tr>
                    <tr>
                        <td>18</td>
                        <td>‡§ï‡•ç‡§∑‡§§‡§ø‡§™‡•Ç‡§∞‡•ç‡§§‡§ø ‡§µ‡§æ‡§™‡§§ ‡§™‡•ç‡§∞‡§æ‡§™‡•ç‡§§ ‡§ó‡§∞‡•á‡§ï‡•ã ‡§∞‡§ï‡§Æ ‡§¶‡§´‡§æ ‡•©‡•ß<br>Amounts derived as Compensation (Section 31)</td>
                        <td><input type="text" class="input-field" id="txtIN17"></td>
                    </tr>
                    <tr>
                        <td>19</td>
                        <td>‡§Æ‡•Å‡§®‡§æ‡§´‡§æ ‡§§‡§•‡§æ ‡§≤‡§æ‡§≠‡§Æ‡§æ ‡§∏‡§Æ‡§æ‡§µ‡•á‡§∂ ‡§ó‡§∞‡•ç‡§®‡•Å ‡§™‡§∞‡•ç‡§®‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§∞‡§ï‡§Æ‡§π‡§∞‡•Å ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§∏‡§Ç‡§≤‡§ó‡•ç‡§® ‡§ó‡§∞‡•ç‡§®‡•á<br>Other Amounts to be included in Profit and Gains (details attached)</td>
                        <td><input type="text" class="input-field" id="txtIN18"></td>
                    </tr>
                    <tr>
                        <td>20</td>
                        <td><strong>‡§ú‡§Æ‡•ç‡§Æ‡§æ:(‡•ß ‡§¶‡•á‡§ñ‡§ø ‡•ß‡•Ø)<br>Total:(1 to 19)</strong></td>
                        <td><input type="text" class="input-field readonly" id="txtIN19" readonly></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Deduction Section -->
        <div class="grid-container">
            <div class="grid-header">Deduction (DE)</div>
            <table>
                <tbody>
                    <tr>
                        <td>21</td>
                        <td>‡§¶‡§´‡§æ ‡•ß‡•™ ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§π‡•Å‡§®‡•á ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§ñ‡§∞‡•ç‡§ö<br>Interest (Section 14)</td>
                        <td><input type="text" class="input-field" id="txtDE0"></td>
                    </tr>
                    <tr>
                        <td>22</td>
                        <td>‡§¶‡§´‡§æ ‡•ß‡•¨ ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§π‡•Å‡§®‡•á ‡§Æ‡§∞‡•ç‡§Æ‡§§ ‡§§‡§•‡§æ ‡§∏‡•Å‡§ß‡§æ‡§∞ ‡§ñ‡§∞‡•ç‡§ö<br>Repairs and Improvements (Section 16)</td>
                        <td><input type="text" class="input-field" id="txtDE1"></td>
                    </tr>
                    <tr>
                        <td>23</td>
                        <td>‡§¶‡§´‡§æ ‡•ß‡•Ø ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§π‡•Å‡§®‡•á ‡§π‡•ç‡§∞‡§æ‡§∏ ‡§ñ‡§∞‡•ç‡§ö<br>Depreciation (Section 19)</td>
                        <td><input type="text" class="input-field" id="txtDE2"></td>
                    </tr>
                    <tr>
                        <td>24</td>
                        <td>‡§â‡§™‡§∞‡•ã‡§ï‡•ç‡§§ ‡§¨‡§æ‡§π‡•á‡§ï ‡§Ü‡§Ø‡§ï‡§∞ ‡§ê‡§® ‡•®‡•¶‡•´‡•Æ ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§π‡•Å‡§®‡•á ‡§Ö‡§®‡•ç‡§Ø ‡§ñ‡§∞‡•ç‡§ö‡§π‡§∞‡•Å ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§∏‡§Ç‡§≤‡§ó‡•ç‡§® ‡§ó‡§∞‡•ç‡§®‡•á<br>Others than mentioned in Lines 18 to 20</td>
                        <td><input type="text" class="input-field" id="txtDE3"></td>
                    </tr>
                    <tr>
                        <td>25</td>
                        <td><strong>‡§ú‡§Æ‡•ç‡§Æ‡§æ:(‡•®‡•ß ‡§¶‡•á‡§ñ‡§ø ‡•®‡•™)<br>Total:(1 to 24)</strong></td>
                        <td><input type="text" class="input-field readonly" id="txtDE4" readonly></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Deductible Loss Section -->
        <div class="grid-container">
            <div class="grid-header">Deductible Loss (DL)</div>
            <table>
                <tbody>
                    <tr>
                        <td>26</td>
                        <td>‡§Ø‡§∏ ‡§Ü.‡§¨.‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§æ ‡§Ö‡§®‡•ç‡§Ø ‡§≤‡§ó‡§æ‡§®‡•Ä‡§ï‡•ã ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§®‡•Ä<br>Losses transferred from other Businesses and/or Investments in this Year</td>
                        <td><input type="text" class="input-field" id="txtDL0"></td>
                    </tr>
                    <tr>
                        <td>27</td>
                        <td>‡§ó‡§§ ‡§Ü.‡§¨. ‡§¨‡§æ‡§ü ‡§ú‡§ø‡§Æ‡•ç‡§Æ‡•á‡§µ‡§æ‡§∞‡•Ä ‡§∏‡§∞‡•á‡§ï‡•ã ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§®‡•Ä<br>Carried forward of unrelieved Business Losses from previous Years</td>
                        <td><input type="text" class="input-field" id="txtDL1"></td>
                    </tr>
                    <tr>
                        <td>28</td>
                        <td><strong>‡§ú‡§Æ‡•ç‡§Æ‡§æ:(‡•®‡•¨ ‡§¶‡•á‡§ñ‡§ø ‡•®‡•≠)<br>Total:(26 to 27)</strong></td>
                        <td><input type="text" class="input-field readonly" id="txtDL2" readonly></td>
                    </tr>
                    <tr>
                        <td>29</td>
                        <td><strong>‡§ú‡§Æ‡•ç‡§Æ‡§æ ‡§ï‡§ü‡•ç‡§ü‡•Ä:(‡•®‡•´ + ‡•®‡•Æ)<br>Total:(25 + 28)</strong></td>
                        <td><input type="text" class="input-field readonly" id="txtDL3" readonly></td>
                    </tr>
                    <tr>
                        <td>30</td>
                        <td><strong>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§Ü‡§Ø ‡§∞ ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§®‡•Ä :(‡•®‡•¶ - ‡•®‡•Ø)<br>Gain or Loss :(20 - 29)</strong></td>
                        <td><input type="text" class="input-field readonly" id="txtDL4" readonly></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Miscellaneous Inclusion Section -->
        <div class="grid-container">
            <div class="grid-header">Miscellaneous Inclusion(MI)</div>
            <table>
                <tbody>
                    <tr>
                        <td>31</td>
                        <td>‡§Ö‡§®‡•ç‡§Ø ‡§≤‡§ó‡§æ‡§®‡•Ä‡§ï‡•ã ‡§Ü‡§Ø‡§Æ‡§æ ‡§ï‡§ü‡•ç‡§ü‡•Ä ‡§ó‡§∞‡•á‡§ï‡•ã ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§®‡•Ä (‡§π‡§∞‡§´ ‡•©‡•ß ‡§Æ‡§æ ‡§®‡•ã‡§ï‡•ç‡§∏‡§æ‡§®‡•Ä ‡§≠‡§è ‡§Æ‡§æ‡§§‡•ç‡§∞ )<br>LOSS TRANSFERRED TO OTHER INVESTMENT INCOMES (only if row 30 is less than 0)</td>
                        <td><input type="text" class="input-field" id="txtMI0"></td>
                    </tr>
                    <tr>
                        <td>32</td>
                        <td><strong>‡§ú‡§Æ‡•ç‡§Æ‡§æ:(‡•©‡•¶ + ‚Äå‡•©‡•ß)<br>Total:(30 + 31)</strong></td>
                        <td><input type="text" class="input-field readonly" id="txtMI1" readonly></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
            <button class="btn-save" id="saveBtn">Save</button>
            <button class="btn-delete" id="deleteBtn">Delete</button>
        </div>
        
        <div class="back-link">
            ‡§™‡§õ‡§æ‡§°‡§ø ‡§ó‡§è‡§∞ ‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä ‡§§‡§Ø ‡§ó‡§∞‡•ç‡§® <a id="backLink2">‡§Ø‡§π‡§æ‡§Å ‡§ï‡§ø‡•ç‡§≤‡§ï</a> ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç ‡•§
        </div>
    </div>

    <script>
        // Auto-calculation functions
        function calculateTotals() {
            // Calculate Inclusion Total (txtIN19)
            let inclusionTotal = 0;
            for (let i = 0; i <= 18; i++) {
                const value = parseFloat(document.getElementById('txtIN' + i).value) || 0;
                inclusionTotal += value;
            }
            document.getElementById('txtIN19').value = inclusionTotal.toFixed(2);

            // Calculate Deduction Total (txtDE4)
            let deductionTotal = 0;
            for (let i = 0; i <= 3; i++) {
                const value = parseFloat(document.getElementById('txtDE' + i).value) || 0;
                deductionTotal += value;
            }
            document.getElementById('txtDE4').value = deductionTotal.toFixed(2);

            // Calculate Deductible Loss totals
            const dl0 = parseFloat(document.getElementById('txtDL0').value) || 0;
            const dl1 = parseFloat(document.getElementById('txtDL1').value) || 0;
            const dl2 = dl0 + dl1;
            document.getElementById('txtDL2').value = dl2.toFixed(2);

            const de4 = parseFloat(document.getElementById('txtDE4').value) || 0;
            const dl3 = de4 + dl2;
            document.getElementById('txtDL3').value = dl3.toFixed(2);

            const in19 = parseFloat(document.getElementById('txtIN19').value) || 0;
            const dl4 = in19 - dl3;
            document.getElementById('txtDL4').value = dl4.toFixed(2);

            // Calculate Miscellaneous Inclusion
            const mi0 = parseFloat(document.getElementById('txtMI0').value) || 0;
            const mi1 = dl4 + mi0;
            document.getElementById('txtMI1').value = mi1.toFixed(2);
        }

        // Add event listeners to all input fields
        document.querySelectorAll('.input-field:not(.readonly)').forEach(input => {
            input.addEventListener('input', calculateTotals);
        });

        // Load taxpayer info from D03 main form
        function loadTaxpayerInfo() {
            const d03Data = localStorage.getItem('d03_return_data');
            if (d03Data) {
                const data = JSON.parse(d03Data);
                document.getElementById('fiscalYear').value = data.fiscalYear || '';
                document.getElementById('internalCode').value = data.iro || '';
                document.getElementById('panNumber').value = data.pan || '';
                document.getElementById('taxpayerName').value = data.taxpayerName || '';
            }
        }

        // Load taxpayer info on page load
        loadTaxpayerInfo();

        // Load data from parent
        window.addEventListener('message', function(event) {
            if (event.data.type === 'loadData') {
                const data = event.data.data;
                if (data) {
                    // Load basic info
                    document.getElementById('fiscalYear').value = data.fiscalYear || '';
                    document.getElementById('internalCode').value = data.internalCode || '';
                    document.getElementById('panNumber').value = data.panNumber || '';
                    document.getElementById('taxpayerName').value = data.taxpayerName || '';

                    // Load inclusion values
                    for (let i = 0; i <= 18; i++) {
                        if (data['txtIN' + i] !== undefined) {
                            document.getElementById('txtIN' + i).value = data['txtIN' + i];
                        }
                    }

                    // Load deduction values
                    for (let i = 0; i <= 3; i++) {
                        if (data['txtDE' + i] !== undefined) {
                            document.getElementById('txtDE' + i).value = data['txtDE' + i];
                        }
                    }

                    // Load deductible loss values
                    for (let i = 0; i <= 1; i++) {
                        if (data['txtDL' + i] !== undefined) {
                            document.getElementById('txtDL' + i).value = data['txtDL' + i];
                        }
                    }

                    // Load miscellaneous inclusion
                    if (data.txtMI0 !== undefined) {
                        document.getElementById('txtMI0').value = data.txtMI0;
                    }

                    calculateTotals();
                }
            }
        });

        // Back link handler
        document.getElementById('backLink').addEventListener('click', function() {
            document.getElementById('confirmModal').style.display = 'flex';
        });
        
        // Back link handler (bottom)
        document.getElementById('backLink2').addEventListener('click', function() {
            document.getElementById('confirmModal').style.display = 'flex';
        });
        
        // Function to close confirmation modal
        function closeConfirmModal() {
            document.getElementById('confirmModal').style.display = 'none';
        }
        
        // Function to confirm going back
        function confirmGoBack() {
            window.parent.postMessage({ type: 'goBackToSetAnnex' }, '*');
        }

        // Save button handler
        document.getElementById('saveBtn').addEventListener('click', function() {
            const data = {
                fiscalYear: document.getElementById('fiscalYear').value,
                internalCode: document.getElementById('internalCode').value,
                panNumber: document.getElementById('panNumber').value,
                taxpayerName: document.getElementById('taxpayerName').value
            };

            // Collect all input values
            for (let i = 0; i <= 19; i++) {
                data['txtIN' + i] = document.getElementById('txtIN' + i).value;
            }
            for (let i = 0; i <= 4; i++) {
                data['txtDE' + i] = document.getElementById('txtDE' + i).value;
            }
            for (let i = 0; i <= 4; i++) {
                data['txtDL' + i] = document.getElementById('txtDL' + i).value;
            }
            for (let i = 0; i <= 1; i++) {
                data['txtMI' + i] = document.getElementById('txtMI' + i).value;
            }

            window.parent.postMessage({ type: 'saveAnnex7', data: data }, '*');
            
            // Show success modal
            document.getElementById('successModal').style.display = 'flex';
        });
        
        // Function to close success modal
        function closeSuccessModal() {
            document.getElementById('successModal').style.display = 'none';
            
            // Change Save button to Update
            const saveBtn = document.getElementById('saveBtn');
            if (saveBtn) {
                saveBtn.textContent = 'Update';
                saveBtn.classList.add('updated');
            }
        }

        // Delete button handler
        document.getElementById('deleteBtn').addEventListener('click', function() {
            if (confirm('‡§ï‡•á ‡§§‡§™‡§æ‡§á‡§Å ‡§Ø‡•ã ‡§°‡§æ‡§ü‡§æ ‡§Æ‡•á‡§ü‡•ç‡§® ‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§π‡•Å‡§®‡•Å‡§π‡•Å‡§®‡•ç‡§õ?')) {
                window.parent.postMessage({ type: 'deleteAnnex7' }, '*');
            }
        });

        // Request data on load
        window.parent.postMessage({ type: 'requestAnnex7Data' }, '*');
    </script>
</body>
</html>
