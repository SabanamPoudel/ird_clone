<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä - ‡•®</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Mukta', Arial, sans-serif;
            background-color: #d4e4f7;
            padding: 0;
            font-size: 13px;
        }
        
        .page-container {
            background-color: #d4e4f7;
            padding: 10px;
        }
        
        .content-wrapper {
            background-color: #ffffff;
            border: 1px solid #999;
            padding: 15px;
        }
        
        .page-title-section {
            background-color: #d4e4f7;
            padding: 8px 10px;
            margin-bottom: 15px;
            border: 1px solid #5b9bd5;
        }
        
        .page-title {
            font-size: 16px;
            font-weight: bold;
            color: #000;
        }
        
        .print-btn {
            background: linear-gradient(to bottom, #ffffff, #e0e0e0);
            border: 1px solid #999;
            padding: 4px 12px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .print-btn:hover {
            background: linear-gradient(to bottom, #f5f5f5, #d0d0d0);
        }
        
        .header {
            text-align: center;
            margin-bottom: 15px;
        }
        
        .header h1 {
            font-size: 18px;
            color: #333;
            margin-bottom: 5px;
        }
        
        .back-link-panel {
            background-color: #dfe9f6;
            border: 1px solid #5b9bd5;
            padding: 8px 10px;
            margin-bottom: 15px;
            font-size: 12px;
        }
        
        .back-link-text {
            color: #000;
        }
        
        .back-link-click {
            color: red;
            text-decoration: underline;
            cursor: pointer;
            font-weight: bold;
        }
        
        .info-header {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #f5f5f5;
            border: 1px solid #ddd;
        }
        
        .info-field {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }
        
        .info-field label {
            font-size: 11px;
            color: #333;
            font-weight: normal;
        }
        
        .info-field input {
            padding: 4px 6px;
            border: 1px solid #ccc;
            background-color: #e9ecef;
            font-size: 12px;
        }
        
        .main-layout {
            display: flex;
            gap: 15px;
        }
        
        .left-section {
            flex: 1;
        }
        
        .right-section {
            width: 320px;
            flex-shrink: 0;
        }
        
        .grid-container {
            overflow-x: auto;
            margin-bottom: 15px;
        }
        
        .data-grid {
            width: 100%;
            border-collapse: collapse;
            border: 1px solid #b3b3b3;
            font-size: 11px;
        }
        
        .data-grid th {
            background: linear-gradient(to bottom, #5b9bd5, #4a8bc2);
            color: white;
            padding: 6px 4px;
            text-align: center;
            border: 1px solid #4a8bc2;
            font-weight: bold;
            font-size: 10px;
            line-height: 1.3;
        }
        
        .data-grid td {
            padding: 2px;
            border: 1px solid #ddd;
            text-align: center;
        }
        
        .data-grid input[type="text"] {
            width: 100%;
            padding: 2px;
            border: none;
            text-align: right;
            font-size: 11px;
            background-color: transparent;
        }
        
        .data-grid input[readonly] {
            background-color: #f5f5f5;
        }
        
        .data-grid .total-row {
            background-color: #e9ecef;
            font-weight: bold;
        }
        
        .liability-panel {
            background-color: #ffffff;
            border: 1px solid #b3b3b3;
            margin-bottom: 15px;
        }
        
        .panel-header {
            background: linear-gradient(to bottom, #5b9bd5, #4a8bc2);
            color: white;
            padding: 6px 8px;
            font-weight: bold;
            font-size: 12px;
            text-align: center;
        }
        
        .panel-body {
            padding: 10px;
            background-color: #f8f9fa;
        }
        
        .panel-row {
            display: flex;
            flex-direction: column;
            margin-bottom: 8px;
            gap: 3px;
        }
        
        .panel-row label {
            font-size: 11px;
            color: #333;
        }
        
        .panel-row input {
            padding: 4px;
            border: 1px solid #ccc;
            background-color: #e9ecef;
            text-align: right;
            font-size: 11px;
        }
        
        .installment-panel {
            background-color: #ffffff;
            border: 1px solid #b3b3b3;
            margin-bottom: 15px;
        }
        
        .installment-body {
            padding: 10px;
            background-color: #f8f9fa;
        }
        
        .installment-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
        }
        
        .installment-table th {
            background-color: #e9ecef;
            padding: 5px;
            border: 1px solid #ddd;
            font-weight: bold;
            text-align: center;
            font-size: 10px;
        }
        
        .installment-table td {
            padding: 4px;
            border: 1px solid #ddd;
        }
        
        .installment-table td:first-child {
            text-align: left;
            padding-left: 5px;
            font-size: 11px;
        }
        
        .installment-table input {
            width: 100%;
            padding: 3px;
            border: none;
            background-color: #e9ecef;
            text-align: right;
            font-size: 11px;
        }
        
        .info-box {
            background-color: #fff9c4;
            border: 2px solid #000;
            padding: 8px 10px;
            margin-bottom: 15px;
            color: #0000ff;
            font-weight: bold;
            font-size: 12px;
        }
        
        .button-container {
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .save-btn {
            background: linear-gradient(to bottom, #f0f0f0, #d0d0d0);
            color: #000;
            border: 1px solid #999;
            padding: 6px 15px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 12px;
            font-weight: normal;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .save-btn:hover {
            background: linear-gradient(to bottom, #e0e0e0, #c0c0c0);
        }
        
        .back-link-bottom {
            margin-top: 10px;
            font-size: 12px;
            background-color: #dfe9f6;
            border: 1px solid #5b9bd5;
            padding: 8px 10px;
        }
        
        .calc-btn {
            background: linear-gradient(to bottom, #ffffff, #e0e0e0);
            border: 1px solid #000;
            color: blue;
            padding: 6px 12px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 11px;
            font-weight: bold;
            width: 100%;
            margin-top: 8px;
        }
        
        .calc-btn:hover {
            background: linear-gradient(to bottom, #f5f5f5, #d0d0d0);
        }
        
        .pay-btn {
            background: linear-gradient(to bottom, #70c770, #50a750);
            color: white;
            border: 1px solid #4a8bc2;
            padding: 5px 12px;
            cursor: pointer;
            border-radius: 3px;
            font-size: 11px;
            width: 100%;
            margin-bottom: 5px;
        }
        
        .pay-btn:hover {
            background: linear-gradient(to bottom, #60b760, #409740);
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="content-wrapper">
            <div class="page-title-section">
                <span class="page-title">Annex-2</span>
            </div>
            
            <button class="print-btn" onclick="window.print()">üñ®Ô∏è Print</button>
            
            <div class="header">
                <h1>‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä -‡•®</h1>
            </div>
            
            <!-- Back Link Panel -->
            <div class="back-link-panel">
                <span class="back-link-text">‡§™‡§õ‡§æ‡§°‡§ø ‡§ó‡§è‡§∞ ‡§Ü‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä ‡§§‡§Ø ‡§ó‡§∞‡•ç‡§® </span>
                <span class="back-link-click" onclick="goBackToSetAnnex()">‡§Ø‡§π‡§æ‡§Å ‡§ï‡§ø‡•ç‡§≤‡§ï</span>
                <span class="back-link-text"> ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç ‡•§</span>
            </div>
            
            <!-- Information Header -->
            <div class="info-header">
                <div class="info-field">
                    <label>‡§Ü‡§∞‡•ç‡§•‡§ø‡§ï ‡§µ‡§∞‡•ç‡§∑:</label>
                    <input type="text" id="fiscalYear" readonly>
                </div>
                <div class="info-field">
                    <label>‡§ï‡§∞‡§ï‡•ã ‡§ï‡§ø‡§∏‡§ø‡§Æ:</label>
                    <input type="text" id="taxType" readonly>
                </div>
                <div class="info-field">
                    <label>‡§∏‡§æ‡§µ‡§Ç‡§ß‡§ø‡§® ‡§®‡§Ç.:</label>
                    <input type="text" id="submissionNo" readonly>
                </div>
                <div class="info-field">
                    <label>‡§∏‡•ç‡§•‡§æ‡§Ø‡•Ä ‡§≤‡•á‡§ñ‡§æ ‡§®‡§Æ‡•ç‡§¨‡§∞:</label>
                    <input type="text" id="pan" readonly>
                </div>
            </div>
            
            <div class="main-layout">
                <!-- Left Section: Main Grid -->
                <div class="left-section">
                    <div class="grid-container">
                        <table class="data-grid">
                            <thead>
                                <tr>
                                    <th rowspan="2">S.N.</th>
                                    <th rowspan="2">‡•ß<br>Annex Type</th>
                                    <th rowspan="2">‡•®<br>Tax Category</th>
                                    <th rowspan="2">‡•©<br>Country Code</th>
                                    <th rowspan="2">‡•™<br>Inclusions</th>
                                    <th rowspan="2">‡•´<br>Income Gain Loss</th>
                                    <th rowspan="2">‡•¨<br>Assessable Income</th>
                                    <th rowspan="2">‡•≠<br>Retirement Fund</th>
                                    <th rowspan="2">‡•Æ<br>Donation</th>
                                    <th rowspan="2">‡•Ø<br>Taxable Income</th>
                                    <th rowspan="2">‡•ß‡•¶<br>Normal Tax Rate</th>
                                    <th rowspan="2">‡•ß‡•ß<br>Concession Category</th>
                                    <th rowspan="2">‡•ß‡•®<br>Concession Rate</th>
                                    <th rowspan="2">‡•ß‡•©<br>Effective Tax Rate</th>
                                    <th rowspan="2">‡•ß‡•™<br>Total Payable Tax</th>
                                </tr>
                            </thead>
                            <tbody id="gridBody">
                                <tr>
                                    <td>1</td>
                                    <td><input type="text" value="Business" readonly></td>
                                    <td><input type="text" value="A2-1" readonly></td>
                                    <td><input type="text" value="np" readonly></td>
                                    <td><input type="text" value="0" readonly></td>
                                    <td><input type="text" value="-9865" readonly></td>
                                    <td><input type="text" value="0" readonly></td>
                                    <td><input type="text" value="" readonly></td>
                                    <td><input type="text"></td>
                                    <td><input type="text" value="0" readonly></td>
                                    <td><input type="text" value="25" readonly></td>
                                    <td><input type="text" value="" readonly></td>
                                    <td><input type="text" value="" readonly></td>
                                    <td><input type="text" value="25" readonly></td>
                                    <td><input type="text" value="0.00" readonly></td>
                                </tr>
                            </tbody>
                            <tfoot>
                                <tr class="total-row">
                                    <td colspan="4" style="text-align: right;">Total</td>
                                    <td><input type="text" id="totalCol4" value="0" readonly></td>
                                    <td><input type="text" id="totalCol5" value="-9865" readonly></td>
                                    <td><input type="text" id="totalCol6" value="0" readonly></td>
                                    <td><input type="text" id="totalCol7" readonly></td>
                                    <td><input type="text" id="totalCol8" readonly></td>
                                    <td><input type="text" id="totalCol9" value="0" readonly></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td><input type="text" id="totalCol14" value="0" readonly></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
                
                <!-- Right Section: Tax Liability Panel -->
                <div class="right-section">
                    <div class="liability-panel">
                        <div class="panel-header">‡§ï‡§∞ ‡§¶‡§æ‡§Ø‡§ø‡§§‡•ç‡§µ</div>
                        <div class="panel-body">
                            <div class="panel-row">
                                <label>‡§∂‡•Å‡§≤‡•ç‡§ï ‡§∞ ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§ó‡§£‡§®‡§æ ‡§ó‡§∞‡•á‡§ï‡•ã ‡§≠‡§è ‡§ó‡§£‡§®‡§æ‡§ï‡•ã ‡§Ö‡§®‡•ç‡§§‡§ø‡§Æ ‡§Æ‡§ø‡§§‡§ø</label>
                                <input type="text" id="calcDate" placeholder="YYYY.MM.DD" maxlength="10">
                            </div>
                            <div class="panel-row">
                                <label>‡§ú‡§Æ‡•ç‡§Æ‡§æ ‡§≤‡§æ‡§ó‡•ç‡§®‡•á ‡§ï‡§∞</label>
                                <input type="text" id="totalTax" value="0.00" readonly>
                            </div>
                            <div class="panel-row">
                                <label>‡§¶‡§´‡§æ ‡•ß‡•ß‡•≠(‡•ß) ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ‡§ï‡•ã ‡§ú‡§Æ‡•ç‡§Æ‡§æ ‡§∂‡•Å‡§≤‡•ç‡§ï</label>
                                <input type="text" id="totalFee117" value="0.00" readonly>
                            </div>
                            <div class="panel-row">
                                <label>‡§µ‡•ç‡§Ø‡§æ‡§ú (‡§¶‡§´‡§æ ‡•ß‡•ß‡•Æ)</label>
                                <input type="text" id="interest118" value="0" readonly>
                            </div>
                            <div class="panel-row">
                                <label>‡§µ‡•ç‡§Ø‡§æ‡§ú (‡§¶‡§´‡§æ ‡•ß‡•ß‡•Ø)</label>
                                <input type="text" id="interest119" value="0.00" readonly>
                            </div>
                            <div class="panel-row">
                                <label>‡§ú‡§Æ‡•ç‡§Æ‡§æ ‡§§‡§ø‡§∞‡•ç‡§®‡•Å ‡§™‡§∞‡•ç‡§®‡•á ‡§ï‡§∞</label>
                                <input type="text" id="totalPayable" value="0.00" readonly>
                            </div>
                            <div class="panel-row">
                                <label>‡§ú‡§Æ‡•ç‡§Æ‡§æ ‡§§‡§ø‡§∞‡•á‡§ï‡•ã ‡§ï‡§∞</label>
                                <input type="text" id="totalPaid" value="0" readonly>
                            </div>
                            <div class="panel-row">
                                <label>‡§¶‡§æ‡§ñ‡§ø‡§≤‡§æ ‡§ó‡§∞‡•ç‡§® ‡§¨‡§æ‡§Å‡§ï‡•Ä ‡§ï‡§∞</label>
                                <input type="text" id="remainingTax" value="0" readonly>
                            </div>
                            <button class="pay-btn">‚úì Pay Now</button>
                            <button class="calc-btn">‡§ï‡§∞ ‡§¶‡§æ‡§Ø‡§ø‡§§‡•ç‡§µ ‡§ó‡§£‡§®‡§æ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Installment Panel -->
            <div class="installment-panel">
                <div class="panel-header">‡§ï‡§ø‡§∏‡•ç‡§§‡§æ ‡§ó‡§£‡§®‡§æ</div>
                <div class="installment-body">
                    <table class="installment-table">
                        <thead>
                            <tr>
                                <th>‡§µ‡§ø‡§µ‡§∞‡§£</th>
                                <th>‡§™‡§π‡§ø‡§≤‡•ã ‡§ï‡§ø‡§∏‡•ç‡§§‡§æ ‡•™‡•¶ ‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§‡§≤‡•á</th>
                                <th>‡§¶‡•ã‡§∏‡•ç‡§∞‡•ã ‡§ï‡§ø‡§∏‡•ç‡§§‡§æ ‡•≠‡•¶ ‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§‡§≤‡•á</th>
                                <th>‡§§‡•á‡§∏‡•ç‡§∞‡•ã ‡§ï‡§ø‡§∏‡•ç‡§§‡§æ ‡•ß‡•¶‡•¶ ‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§‡§≤‡•á</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>‡§Ü‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ ‡§ï‡§ø‡§∏‡•ç‡§§‡§æ ‡§∞‡§ï‡§Æ ‡§∞‡•Å</td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                            </tr>
                            <tr>
                                <td>‡§™‡•Å‡§∞‡•ç‡§µ‡§æ‡§Æ‡§æ‡§®‡§ø‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ ‡§ï‡§ø‡§∏‡•ç‡§§‡§æ ‡§∞‡§ï‡§Æ ‡§∞‡•Å</td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                            </tr>
                            <tr>
                                <td>‡§§‡§ø‡§∞‡•á‡§ï‡•ã ‡§∞‡§ï‡§Æ ‡•ß‡•ß‡•Æ(‡•ß)(‡§ï) ‡§∞‡•Å</td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                            </tr>
                            <tr>
                                <td>‡§®‡•ç‡§Ø‡•Ç‡§®‡§§‡§Æ ‡§§‡§ø‡§®‡•Å‡§™‡§∞‡•ç‡§®‡•á ‡§∞‡§ï‡§Æ ‡•ß‡•ß‡•Æ(‡•ß)(‡§ñ) ‡§∞‡•Å</td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                            </tr>
                            <tr>
                                <td>‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§≤‡§æ‡§ó‡•ç‡§®‡•á ‡§∞‡§ï‡§Æ ‡§∞‡•Å</td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                            </tr>
                            <tr>
                                <td>‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§∞‡§ï‡§Æ ‡§∞‡•Å</td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                                <td><input type="text" value="0" readonly></td>
                            </tr>
                            <tr>
                                <td>‡§¶‡§´ ‡•ß‡•ß‡•Æ ‡§¨‡§Æ‡•ã‡§ú‡§ø‡§Æ‡§ï‡•ã ‡§ï‡•Å‡§≤ ‡§¨‡•ç‡§Ø‡§æ‡§ú ‡§∞‡§ï‡§Æ ‡§∞‡•Å</td>
                                <td></td>
                                <td></td>
                                <td><input type="text" value="0" readonly></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- Info Box -->
            <div class="info-box">
                ‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä ‡•ß‡•¶ ‡§¨‡§æ‡§ü ‡§ï‡§∞ ‡§≠‡•Å‡§ï‡•ç‡§§‡§æ‡§®‡•Ä ‡§¶‡§æ‡§¨‡•Ä ‡§∞‡•Å.0
            </div>
            
            <!-- Save Button -->
            <div class="button-container">
                <button class="save-btn" onclick="saveAnnex2()">
                    <span>üíæ</span>
                    <span>Save Annex 2</span>
                </button>
            </div>
            
            <!-- Bottom Back Link -->
            <div class="back-link-bottom">
                <span class="back-link-text">‡§™‡§õ‡§æ‡§°‡§ø ‡§ó‡§è‡§∞ ‡§Ü‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä ‡§§‡§Ø ‡§ó‡§∞‡•ç‡§® </span>
                <span class="back-link-click" onclick="goBackToSetAnnex()">‡§Ø‡§π‡§æ‡§Å ‡§ï‡§ø‡•ç‡§≤‡§ï</span>
                <span class="back-link-text"> ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç ‡•§</span>
            </div>
        </div>
    </div>
    
    <script>
        // Load taxpayer information from D03 return data
        function loadTaxpayerInfo() {
            const d03Data = JSON.parse(localStorage.getItem('d03_return_data') || '{}');
            
            if (d03Data.fiscalYear) {
                document.getElementById('fiscalYear').value = d03Data.fiscalYear;
            }
            if (d03Data.pan) {
                document.getElementById('pan').value = d03Data.pan;
            }
            
            // Set default tax type
            document.getElementById('taxType').value = '‡§Ü‡§Ø‡§ï‡§∞';
        }
        
        // Save Annex 2 data
        function saveAnnex2() {
            const annex2Data = {
                fiscalYear: document.getElementById('fiscalYear').value,
                taxType: document.getElementById('taxType').value,
                submissionNo: document.getElementById('submissionNo').value,
                pan: document.getElementById('pan').value,
                calcDate: document.getElementById('calcDate').value,
                totalTax: document.getElementById('totalTax').value,
                saved: true
            };
            
            localStorage.setItem('d03_annex2_data', JSON.stringify(annex2Data));
            alert('‡§Ö‡§®‡•Å‡§∏‡•Ç‡§ö‡•Ä ‡•® ‡§∏‡§´‡§≤‡§§‡§æ‡§™‡•Ç‡§∞‡•ç‡§µ‡§ï ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§ó‡§∞‡§ø‡§Ø‡•ã‡•§\n(Annex 2 saved successfully.)');
        }
        
        // Load saved data if exists
        function loadAnnex2Data() {
            const savedData = JSON.parse(localStorage.getItem('d03_annex2_data') || '{}');
            
            if (savedData.calcDate) {
                document.getElementById('calcDate').value = savedData.calcDate;
            }
        }
        
        // Go back to set annex page
        function goBackToSetAnnex() {
            window.parent.postMessage({ action: 'goBackToSetAnnex' }, '*');
        }
        
        // Initialize on page load
        window.addEventListener('DOMContentLoaded', function() {
            loadTaxpayerInfo();
            loadAnnex2Data();
        });
    </script>
</body>
</html>
