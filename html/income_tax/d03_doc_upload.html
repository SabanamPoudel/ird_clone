<!DOCTYPE html>
<html lang="ne">
<head>
    <meta charset="UTF-8">
    <title>Document Upload D03</title>
    <style>
        body {
            background: #e9eef6;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .outer-panel {
            width: 970px;
            margin: 30px auto;
            background: #fff;
            border: 1px solid #b5cbe8;
            box-shadow: 0 2px 8px #0001;
            border-radius: 6px;
        }
        .panel-header {
            background: linear-gradient(to right, #eaf3fb, #d9e8fb);
            border-bottom: 1px solid #b5cbe8;
            padding: 12px 24px;
            font-size: 18px;
            font-weight: bold;
            color: #1a3c6c;
        }
        .panel-header .back-link {
            color: red;
            text-decoration: underline;
            cursor: pointer;
            font-size: 15px;
            margin-left: 8px;
        }
        .panel-body {
            padding: 24px;
        }
        .upload-section {
            background: #f7fafd;
            border: 1px solid #d0e3f7;
            border-radius: 4px;
            padding: 18px 24px;
            margin-bottom: 24px;
        }
        .upload-section label {
            font-size: 14px;
            color: #333;
            margin-bottom: 8px;
            display: block;
        }
        .upload-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        .upload-row input[type="text"] {
            width: 260px;
            padding: 6px 10px;
            border: 1px solid #b5cbe8;
            border-radius: 3px;
            background: #f9f9f9;
        }
        .upload-row input[type="file"] {
            font-size: 14px;
        }
        .upload-row button {
            padding: 6px 18px;
            background: linear-gradient(to bottom, #eaf3fb, #c5d9ed);
            border: 1px solid #b5cbe8;
            border-radius: 3px;
            font-size: 14px;
            cursor: pointer;
        }
        .upload-row button.sample {
            background: linear-gradient(to bottom, #f5f5f5, #e0e0e0);
            color: #333;
        }
        .note {
            font-size: 13px;
            color: #444;
            background: #fffbe6;
            border: 1px solid #ffe58f;
            padding: 10px 16px;
            border-radius: 3px;
            margin-bottom: 18px;
        }
        .uploaded-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 18px;
        }
        .uploaded-table th, .uploaded-table td {
            border: 1px solid #b5cbe8;
            padding: 7px 10px;
            font-size: 13px;
            text-align: left;
        }
        .uploaded-table th {
            background: #eaf3fb;
        }
        .uploaded-table td.action {
            text-align: center;
        }

        /* Disclaimer Banner */
        .disclaimer-banner {
            background-color: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
            padding: 15px 20px;
            margin: 10px;
            border-radius: 5px;
            font-size: 14px;
            line-height: 1.6;
            text-align: left;
        }

        @media screen and (max-width: 768px) {
            .disclaimer-banner {
                font-size: 12px;
                padding: 12px 15px;
            }
        }

        @media screen and (max-width: 480px) {
            .disclaimer-banner {
                font-size: 11px;
                padding: 10px 12px;
            }
        }
    </style>
</head>
<body>    <!-- Disclaimer Banner -->
    <div class="disclaimer-banner">
        <strong>⚠️ IMPORTANT NOTICE:</strong> This website is provided strictly for training and demonstration purposes only. 
        It is NOT connected to the official Inland Revenue Department (IRD) of Nepal. 
        Do not enter any real, sensitive, or confidential taxpayer information. 
        Any data entered here will not be processed or submitted to the actual IRD system. 
        For official tax filing, please visit the authentic IRD portal.
    </div>
    <div class="ird-main-panel">
        <div class="ird-header">
            <b>Document Upload D03</b> ( पछाडि गएर अनुसूची तय गर्न <span class="ird-back-link" id="backLinkBtn">यहाँ क्लिक</span> गर्नुहोस् ! )
        </div>
            <!-- Confirm Action Modal -->
            <div id="confirmBackModal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.18);align-items:flex-start;justify-content:center;">
                <div style="background:#ced9e7;border-radius:8px;min-width:320px;max-width:90vw;padding:18px 28px 18px 28px;box-shadow:0 4px 24px #0002;position:relative;border:1.5px solid #8cb3df;margin-top:40px;">
                    <div style="font-size:17px;font-weight:bold;color:#003366;margin-bottom:10px;display:flex;align-items:center;gap:7px;">
                        <img src="https://cdn-icons-png.flaticon.com/512/3524/3524752.png" style="height:24px;vertical-align:middle;"> Confirm Action
                        <span onclick="hideConfirmBackModal()" style="position:absolute;top:8px;right:14px;font-size:20px;cursor:pointer;color:#888;">&times;</span>
                    </div>
                    <div style="font-size:15px;margin-bottom:18px;">के तपाई पछाडि गएर अनुसूची तय गर्न चाहनुहुन्छ?</div>
                    <div style="text-align:center;">
                        <button id="confirmBackYesBtn" style="padding:4px 22px;background:#eaf3fb;border:1.5px solid #8cb3df;border-radius:3px;font-size:15px;cursor:pointer;color:#003366;font-weight:bold;margin-right:10px;">Yes</button>
                        <button id="confirmBackNoBtn" style="padding:4px 22px;background:#f5f5f5;border:1.5px solid #ccc;border-radius:3px;font-size:15px;cursor:pointer;color:#444;font-weight:bold;">No</button>
                    </div>
                </div>
            </div>
            <script>
                // ...existing code...
                // Modal logic for back link
                document.getElementById('backLinkBtn').onclick = function() {
                    document.getElementById('confirmBackModal').style.display = 'flex';
                };
                function hideConfirmBackModal() {
                    document.getElementById('confirmBackModal').style.display = 'none';
                }
                document.getElementById('confirmBackNoBtn').onclick = hideConfirmBackModal;
                document.getElementById('confirmBackYesBtn').onclick = function() {
                    window.location.href = 'd03_set_annex.html';
                };
            </script>
        <div class="ird-section-panel">
            <div class="ird-section-header">Fiscal Documents</div>
            <div class="ird-section-body">
                <div class="ird-note">( नोट: Balance Sheet, cash flow statement, income statement, financial report annexes र note to account एउटै pdf बनाएर राख्नु होला | फाईल बढीमा 10 MB सम्मको मात्र हुनुपर्ने छ । )</div>
                <div class="ird-upload-row">
                    <label style="min-width:60px;">File:</label>
                    <input type="text" id="fileName" readonly class="ird-input">
                    <input type="file" id="fileInput" class="ird-file-input" style="display:none;">
                    <button class="ird-btn" onclick="document.getElementById('fileInput').click()">Browse...</button>
                    <button class="ird-btn upload" onclick="uploadFile()"><img src="https://cdn-icons-png.flaticon.com/512/724/724933.png" style="height:18px;vertical-align:middle;margin-right:2px;"> Upload</button>
                </div>
                <div class="ird-table-header">Uploaded Files ...</div>
                <table class="ird-table" id="uploadedTable">
                    <thead>
                        <tr>
                            <th>File Name</th>
                            <th>File Type</th>
                            <th style="width:40px;"></th>
                            <th style="width:40px;"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Uploaded files will appear here -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <style>
        body {
            background: #e3edfa;
            margin: 0;
            font-family: Arial, sans-serif;
        }
        .ird-main-panel {
            margin: 18px auto;
            border: 2px solid #8cb3df;
            border-radius: 7px;
            background: #e3edfa;
            padding: 6px 6px 16px 6px;
            max-width: 900px;
        }
        .ird-header {
            font-size: 15px;
            color: #003366;
            background: #d4e4f7;
            border: 1.5px solid #8cb3df;
            border-radius: 6px 6px 0 0;
            padding: 7px 14px 6px 14px;
            margin-bottom: 12px;
            font-weight: 600;
        }
        .ird-back-link {
            color: red;
            text-decoration: underline;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
        }
        .ird-section-panel {
            border: 2px solid #8cb3df;
            border-radius: 7px;
            background: #f7fbff;
            margin: 0 4px;
        }
        .ird-section-header {
            background: #c7dbf4;
            color: #003366;
            font-size: 13px;
            font-weight: bold;
            border-bottom: 1.5px solid #8cb3df;
            padding: 6px 12px;
            border-radius: 7px 7px 0 0;
        }
        .ird-section-body {
            padding: 12px 12px 16px 12px;
        }
        .ird-note {
            font-size: 12px;
            color: #222;
            margin-bottom: 12px;
        }
        .ird-upload-row {
            display: flex;
            align-items: center;
            gap: 7px;
            margin-bottom: 12px;
        }
        .ird-input {
            width: 260px;
            padding: 4px 8px;
            border: 1.5px solid #8cb3df;
            border-radius: 3px;
            background: #fff;
            font-size: 13px;
        }
        .ird-file-input {
            font-size: 13px;
            background: #fff;
            border: none;
        }
        .ird-btn {
            padding: 3px 12px;
            background: linear-gradient(to bottom, #f7fbff, #c7dbf4);
            border: 1.5px solid #8cb3df;
            border-radius: 3px;
            font-size: 13px;
            cursor: pointer;
            color: #003366;
            font-weight: 600;
        }
        .ird-btn.upload {
            background: linear-gradient(to bottom, #eaf6ff, #b7d0f7);
            color: #003366;
        }
        .ird-table-header {
            background: #c7dbf4;
            color: #003366;
            font-size: 13px;
            font-weight: bold;
            border: 1.5px solid #8cb3df;
            border-radius: 5px 5px 0 0;
            padding: 4px 8px;
            margin-bottom: 0;
        }
        .ird-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 0;
            background: #fff;
        }
        .ird-table th, .ird-table td {
            border: 1.5px solid #8cb3df;
            padding: 5px 7px;
            font-size: 13px;
            text-align: left;
        }
        .ird-table th {
            background: #eaf3fb;
            color: #003366;
            font-weight: bold;
        }
        .ird-table td {
            background: #fff;
        }
        .ird-table td.action {
            text-align: center;
        }
        .ird-icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 0 4px;
        }
        .ird-icon-btn img {
            height: 16px;
            vertical-align: middle;
        }
    </style>

    <!-- Modal for file preview -->
    <div id="filePreviewModal" style="display:none;position:fixed;z-index:9999;left:0;top:0;width:100vw;height:100vh;background:rgba(0,0,0,0.25);align-items:center;justify-content:center;">
        <div style="background:#fff;border-radius:8px;min-width:320px;max-width:90vw;padding:28px 32px 18px 32px;box-shadow:0 4px 24px #0002;position:relative;">
            <div style="font-size:18px;font-weight:bold;color:#003366;margin-bottom:10px;">Uploaded File Details</div>
            <div id="previewFileName" style="margin-bottom:8px;font-size:15px;"></div>
            <div id="previewFileType" style="margin-bottom:16px;font-size:14px;color:#555;"></div>
            <div id="previewFileAction"></div>
            <button onclick="closePreviewModal()" style="margin-top:18px;padding:5px 22px;background:#eaf3fb;border:1.5px solid #8cb3df;border-radius:3px;font-size:15px;cursor:pointer;color:#003366;font-weight:bold;">Close</button>
            <span onclick="closePreviewModal()" style="position:absolute;top:8px;right:16px;font-size:22px;cursor:pointer;color:#888;">&times;</span>
        </div>
    </div>
    <script>
        // File input logic for Browse button
        document.addEventListener('DOMContentLoaded', function() {
            var fileInput = document.getElementById('fileInput');
            var fileNameInput = document.getElementById('fileName');
            if (fileInput) {
                fileInput.addEventListener('change', function() {
                    fileNameInput.value = fileInput.files[0] ? fileInput.files[0].name : '';
                });
            }
        });

        // Store uploaded files in memory for preview
        var uploadedFiles = [];

        function uploadFile() {
            var fileInput = document.getElementById('fileInput');
            var fileName = fileInput.files[0] ? fileInput.files[0].name : '';
            var fileType = fileInput.files[0] ? fileInput.files[0].type : '';
            var fileObj = fileInput.files[0] || null;
            if (!fileName) { alert('Please select a file!'); return; }
            var table = document.getElementById('uploadedTable').getElementsByTagName('tbody')[0];
            var row = table.insertRow();
            row.insertCell(0).innerText = fileName;
            row.insertCell(1).innerText = fileType || 'application/pdf';
            // Eye icon
            var viewCell = row.insertCell(2);
            viewCell.className = 'action';
            var viewBtn = document.createElement('button');
            viewBtn.className = 'ird-icon-btn';
            viewBtn.title = 'View';
            viewBtn.innerHTML = '<img src="https://cdn-icons-png.flaticon.com/512/709/709612.png" alt="View">';
            // Store file info for preview
            var fileIndex = uploadedFiles.length;
            uploadedFiles.push({ name: fileName, type: fileType, file: fileObj });
            viewBtn.onclick = function() { openPdfInNewTab(fileIndex); };
            viewCell.appendChild(viewBtn);
            // Delete icon
            var delCell = row.insertCell(3);
            delCell.className = 'action';
            var delBtn = document.createElement('button');
            delBtn.className = 'ird-icon-btn';
            delBtn.title = 'Delete';
            delBtn.innerHTML = '<img src="https://cdn-icons-png.flaticon.com/512/1214/1214428.png" alt="Delete">';
            delBtn.onclick = function() { table.deleteRow(row.rowIndex-1); uploadedFiles[fileIndex] = null; };
            delCell.appendChild(delBtn);
            // Reset file input
            fileInput.value = '';
            document.getElementById('fileName').value = '';
        }

        function openPdfInNewTab(idx) {
            var file = uploadedFiles[idx];
            if (!file || !file.file) return;
            var url = URL.createObjectURL(file.file);
            window.open(url, '_blank');
        }
    </script>
